{
 "scripts": [
  {
   "header": {
    "cloudId": "touchdevelop.com",
    "scriptId": "bhqnec",
    "userId": "bojcp",
    "status": "published",
    "lastUse": 1505408080,
    "editor": "touchdevelop",
    "name": "fabulous Flatverse",
    "comment": ""
   },
   "source": "meta version \"v2.2,js,ctx,refs,localcloud,unicodemodel,allasync,upperplex\";\nmeta name \"fabulous Flatverse\";\nmeta rootId \"DKJ2iRhROaFaChGKSjgWmF2S\";\nmeta hasIds \"yes\";\nmeta platform \"current\";\nmeta parentIds \"\";\n#H1oSEjPROz2CXFK6\naction main() {\n  #XE1GXtzAgysXQG57 $game_board := @\\u267b→game→start;\n  #NbRK0zHbZva2cSOO @\\u267b→game→set_life(1);\n  #TFppz19OQT70qjS6 @\\u267b→game→set_background_scene(\"horizontal\", art→Space);\n  #uKnip4Oor0DbU6ya @\\u267b→game→bounce_on_sides;\n  #VUU4ruHYAqGtrcCR code→set_game_control_values;\n  #xRpRgKEQKao8Q2aP $hero := $game_board→create_picture(art→trollface2);\n  #xqYIT71fX7FjNq4W $hero→set_color(colors→green);\n  #mzAApPSOC2tHmvMI $hero→set_gradient(false);\n  #snfCjucqO4HWiDuB $game_board→on_tap($tapped);\n  #PPVbpBsyzzbQT4DF where tapped(x: Number, y: Number) {\n    #fmN68VEZcoQ8sE15 $x_speed := code→calculate_x_speed($x, $y, $hero);\n    #i9C02SjDH4HX7vmJ $y_speed := code→calculate_y_speed($x, $y, $hero);\n    #uMIdSD4eEZj5Ndr5 $hero→set_speed($x_speed, $y_speed);\n  }\n  #GRq4g0ZAD46dXHjl $chaser := $game_board→create_picture(art→The_Red_Planet);\n  #xErP45ok10AL1mEs code→set_sprite_position($chaser, $game_board);\n  #Jjf2VU18bq3xF4XB code→set_sprite_size($chaser);\n  #XpZXFXUYDSt9V2MA $obstacle_set := $game_board→create_sprite_set;\n  #HvZv3ZB6LcyKngnQ for 0 ≤ i < 50 do {\n    #x4lHINE94ac1mzl0 $obstacle := $game_board→create_picture(art→cheese);\n    #jM4WHnm6aNeDpMPr $obstacle_set→add($obstacle);\n    #QKQQ0ii2jOtdmdXt code→set_sprite_size($obstacle);\n    #R023z5n6v9IBf5vb code→set_sprite_position($obstacle, $game_board);\n  }\n  #VqNHugztnNkUhrGZ $game_board→on_every_frame;\n  #O1YQbRgonvz4MLXE where `implicit` \\_body\\_() {\n    #FXkceineGFVFfV9M if $chaser→overlaps_with($hero) then {\n      #jkuAcWSAUqFVs2f6 if $chaser→width ≤ $hero→width then {\n        #esjqMLrANhAg88aS @\\u267b→game→add_score($chaser→width);\n        #Lv4gYD8MOH8Aeg6W code→set_sprite_size($chaser);\n        #p2yT7AABoaUhqACe code→set_sprite_position($chaser, $game_board);\n        #FYu4IybKvaxa5e2p code→grow_sprite($hero);\n      }\n      else {\n        #JOZh4IYwBLORSYY7 code→shrink_sprite($hero);\n      }\n    }\n    else {\n      #yFkqlQ73mhC5r4TG $chaser→move_towards($hero, .01);\n      #mW6CDprg6SPehHPi skip;\n    }\n    #LT4meNZQGHy88n8m foreach obstacle in $obstacle_set\n    do {\n      #AeyjRQ1mZnH8RoGX if $obstacle→overlaps_with($hero) then {\n        #mXr2Go3NmhuwJoGc if $obstacle→width ≤ $hero→width then {\n          #paNscWCmYM1VqcA3 @\\u267b→game→add_score($obstacle→width);\n          #jACa4RVz4lSvSvuc code→set_sprite_size($obstacle);\n          #yjbplhJLlMUtyNaw code→set_sprite_position($obstacle, $game_board);\n          #D6MibnsCIpiGqz9t code→grow_sprite($hero);\n        }\n        else {\n          #xtIoWm2yvwnY0z49 code→shrink_sprite($hero);\n        }\n      }\n      #sjET6TDlWA4r22EF if $obstacle→overlaps_with($chaser) then {\n        #WTWpYVI4PhBSG6er code→bounce($chaser, $obstacle);\n      }\n    }\n    #aD2SmWT7ShDPo0lt if data→hero_size < data→min_hero_size then {\n      #Hm2NO1fVDo8CJ9cx @\\u267b→game→remove_life(1);\n    }\n    #VRu4ArtSRuLdMZqX data→hero_speed_factor := data→initial_hero_size / $hero→width * data→initial_hero_speed;\n    #P9kVJ9UoZ6AfaWqi if data→hero_size > data→max_hero_size then {\n      #qa48Lzdxlco2jPYx data→hero_size := data→initial_hero_size;\n    }\n  }\n}\n#rej9i1FGvTLHy54D\naction calculate_x_speed(#IHSIb7iM3Sr6Jbh0 x\\u002dcoord: Number, #xLEcTTLHCgmwSrBB y\\u002dcoord: Number, #KpiJOmf8Jdl205Ur moving_sprite: Sprite) returns(#FkqaLCvnfn3qy6QF speed_in_x_direction: Number) {\n  #Adgv4fh9qaJwDmHc $hyp := math→sqrt(math→pow($x\\u002dcoord - $moving_sprite→x, 2) + math→pow($y\\u002dcoord - $moving_sprite→y, 2));\n  #a2awaAa2zTdmyROS if $x\\u002dcoord = $moving_sprite→x then {\n    #xpAsNuxfht4z2LJh $speed_in_x_direction := 0;\n  }\n  else {\n    #xsnCV8bIcUEyXznD $speed_in_x_direction := data→hero_speed_factor * ($x\\u002dcoord - $moving_sprite→x) / $hyp;\n  }\n}\n#xSeMQ5jCTot4uFJP\naction calculate_y_speed(#t0NhsxCEbdS5jvj7 x\\u002dcoord: Number, #OZGlMfdYShWuw1Ho y\\u002dcoord: Number, #xgrDuvh2eIQMc9KI moving_sprite: Sprite) returns(#HYYJ92knVYTnkIRW speed_in_y_direction: Number) {\n  #dOYtgvE3FjtRbvmG $hyp := math→sqrt(math→pow($x\\u002dcoord - $moving_sprite→x, 2) + math→pow($y\\u002dcoord - $moving_sprite→y, 2));\n  #IWh2d2fydA2Vg6eJ if $x\\u002dcoord = $moving_sprite→y then {\n    #BGwPgyFk5zpns2PW $speed_in_y_direction := 0;\n  }\n  else {\n    #xgwqk1uIN4nmysDm $speed_in_y_direction := data→hero_speed_factor * ($y\\u002dcoord - $moving_sprite→y) / $hyp;\n  }\n}\n#xUHtBVYA2x3merKF\naction set_game_control_values() {\n  #mENjTDKNwadJy93I data→initial_hero_size := 20;\n  #wWH4DwArsKtrTovh data→hero_size := 20;\n  #HsuZ3dssZgmYZSRO data→min_hero_size := 10;\n  #QDXPJobIpG18Fr6m data→max_hero_size := 100;\n  #RqkoziVmSqjfpPn4 data→initial_hero_speed := 80;\n  #PzJWTdioSboNwmg2 data→hero_shrink_factor := .95;\n  #tWJ4o305hPCydtAt data→hero_grow_factor := 1.1;\n  #xNF3Hi84V42o4w8m data→hero_speed_factor := 80;\n}\n#Gip6crUR8uZExiuk\naction set_sprite_position(#DgBHTrc6mMjWoagL obstacle_sprite: Sprite, #OWNagQROU0ocdpHx board: Board) {\n  #sHTas1zkuMvOwLbd $x := math→random_range(0, $board→width);\n  #rRxXN5UDPyHQaZpX $y := math→random_range(0, $board→height);\n  #ZlxKtKbWX7VVLwED $obstacle_sprite→set_pos($x, $y);\n  #g6kdHOXj2CSFvcn4 code→create_safe_zone($obstacle_sprite, $board);\n  #aY1cRbp2d1T5bYN1 $obstacle_sprite→set_color(colors→random);\n  #FoXfVT5142Vnhzva $obstacle_sprite→set_gradient(false);\n}\n#p4zuLxZ6uB4uGNAx\naction create_safe_zone(#DEI7UodH4XCbdj3E obstacle_sprite: Sprite, #xOuqT2Mdq6h9RRvw board: Board) {\n  #xuWm2djJ7DYdrdQi $clear_area := $board→create_ellipse(50, 50);\n  #xiyKHN68Z2mr2Erb $clear_area→set_color(colors→transparent);\n  #xROhBvEHEMdUj461 $clear_area→set_z_index( - 1);\n  #xbN6lRSzhlSt8qXe if $obstacle_sprite→overlaps_with($clear_area) then {\n    #dUmewhsQYZE2l7mL code→set_sprite_position($obstacle_sprite, $board);\n  }\n  #qVcRULw9kV2DrFEn $clear_area→delete;\n}\n#xyYhmeerUGHkJNi9\naction set_sprite_size(#BmolX6vhSru2SrCZ changing_sprite: Sprite) {\n  #eiwtDDbxDGsd2VR1 $obstacle_size := 20;\n  #r072goRIRVZ2BHtc $random_num := math→random_range(0, 2);\n  #n6hQWRNbSHp4ZZpk if $random_num = 0 `or` $random_num = 1 then {\n    #xZw2D5AV6yoNI1nP $obstacle_size := math→random_range(5, data→hero_size - 1);\n  }\n  else {\n    #jBR8JkV4qDl7DI9Y $obstacle_size := math→random_range(data→hero_size, data→max_hero_size);\n  }\n  #kZyZllDL1dU4eg28 $changing_sprite→set_width($obstacle_size);\n  #JUOr21Kti2PxDGLd $changing_sprite→set_height($obstacle_size);\n}\n#QWsnXTwYNixUlCkQ\naction shrink_sprite(#Ujuzs0THur0jYuJl shrinking_sprite: Sprite) {\n  #C2tbcCB9u8bK5icl data→hero_size := data→hero_size * data→hero_shrink_factor;\n  #c38EgiuxfqGSHkxg $shrinking_sprite→set_width(data→hero_size);\n  #hs4k9N7EV4Jed0J2 $shrinking_sprite→set_height(data→hero_size);\n}\n#x0K5B86ATWi89mNW\naction grow_sprite(#xxlLLzPU2CTL3slJ growing_sprite: Sprite) {\n  #xoiK4Qxwlvx4Jqaq data→hero_size := data→hero_size * data→hero_grow_factor;\n  #LsC2O64CxuWTwP2x $growing_sprite→set_width(data→hero_size);\n  #VTZNyezhURQoG46j $growing_sprite→set_height(data→hero_size);\n}\n#hwajoE6naUavjrEI\naction bounce(#QS46qXZz5fmNjihD bounce_sprite: Sprite, #BIHfBKoklQnhucft stationary_sprite: Sprite) {\n  #fYEDUBRgwXY37vY4 $bounce_sprite→set_pos($bounce_sprite→x + .1 * ($bounce_sprite→x - $stationary_sprite→x), $bounce_sprite→y + .1 * ($bounce_sprite→y - $stationary_sprite→y));\n}\n#PcYX0DBPldGcUjbz meta import game {\n  pub \"nzvufl\"\n  usage {\n    #BVGhpbmca\n    table Splash_Options {\n      type = \"Object\";\n      exported = true;\n      persistent = false;\n      fields {\n        #X13V3PCWTQpT2ORT seconds : Number\n        #nk8FBg8KCO4gn30S foreground_color : Color\n        #Tl89ovYzNYTzCj6A background_color : Color\n      }\n    }\n    action `sync` set_score(value: Number)\n    action `async` set_life(value: Number)\n    action `sync` start_timer()\n    action `sync` start_countdown_timer(seconds: Number)\n    action `sync` life() returns(r: Number)\n    action `sync` score() returns(r: Number)\n    action `sync` current_time() returns(seconds: Number)\n    action `sync` add_score(value: Number)\n    action `async` add_life(value: Number)\n    action `sync` clear_timer()\n    action `async` remove_life(value: Number)\n    action `async` end()\n    action `async` start() returns(board: Board)\n    action `sync` reset()\n    action `async` start_with_fixed_size(width: Number, height: Number) returns(board: Board)\n    action `async` start_with_background_picture(pic: Picture) returns(board: Board)\n    action `sync` board() returns(board: Board)\n    action `sync` on_end(body: Action)\n    action `async` start_landscape() returns(board: Board)\n    action `async` start_portrait() returns(board: Board)\n    action `sync` set_hud_colors(life: Color, timer: Color, score: Color)\n    action `sync` hud_sprites() returns(sprites: Sprite_Set)\n    action `async` life_visible() returns(b: Boolean)\n    action `async` set_life_visible(visible: Boolean)\n    action `sync` sprites() returns(sprites: Sprite_Set)\n    action `async` set_background_scene(direction: String, pic: Picture)\n    action `sync` bounce_on_sides()\n    action `sync` create_sprite(pic: Picture) returns(sprite: Sprite)\n    action `async` splash(message: String, options\\u003f: ♻ game → Splash_Options)\n    action `async` splash_text(message: String, seconds: Number, foreground: Color, background: Color, done: Action)\n  }\n}\n#xOTQINH2kgFqXWu8\nvar initial_hero_size : Number {\n  transient = true;\n}\n#CzPuMfDpc2DEvy75\nvar hero_size : Number {\n  transient = true;\n}\n#xRFyVEdV4TmzRUbl\nvar min_hero_size : Number {\n  transient = true;\n}\n#Xqd34NxVRhPp8PwT\nvar max_hero_size : Number {\n  transient = true;\n}\n#SO4Ce1Yt4i3uWquG\nvar initial_hero_speed : Number {\n  transient = true;\n}\n#wm4Jtl6MxF7Ns2V5\nvar hero_shrink_factor : Number {\n  transient = true;\n}\n#s5GIUPHoSNn1xWa1\nvar hero_grow_factor : Number {\n  transient = true;\n}\n#nLP0opU4g4IaPoS5\nvar hero_speed_factor : Number {\n  transient = true;\n}\n#xV23D56NTjhYzNxK\nvar trollface : Picture {\n  is\\_resource = true;\n  url = \"https://az820584.vo.msecnd.net/pub/htwscsox\";\n  transient = true;\n}\n#xNZ6uFa2hT62h2A3\nvar trollface2 : Picture {\n  is\\_resource = true;\n  url = \"https://az820584.vo.msecnd.net/pub/htwscsox\";\n  transient = true;\n}\n#KOGhrUbkZardr0xQ\nvar lolo : Picture {\n  is\\_resource = true;\n  url = \"https://az820584.vo.msecnd.net/pub/uimwgixk\";\n  transient = true;\n}\n#U1CEDsQ9OiEC0Az4\nvar Space : Picture {\n  is\\_resource = true;\n  url = \"https://az820584.vo.msecnd.net/pub/fkuxalbn\";\n  transient = true;\n}\n#UuSsRkXbV4CnhMzG\nvar The_Red_Planet : Picture {\n  is\\_resource = true;\n  url = \"https://az820584.vo.msecnd.net/pub/dsvdasnt\";\n  transient = true;\n}\n#xq9XJv14I8kFDeHq\nvar cheese : Picture {\n  is\\_resource = true;\n  url = \"https://az820584.vo.msecnd.net/pub/ornvpmmo\";\n  transient = true;\n}\n"
  }
 ]
}